% file: elem4.mfunction [ke] = elem4(node,x,y,gauss,young,pr,e)% 2D Quad Element Stiffness Subroutineke = zeros(8,8);one = ones(1,4);ksiJ=[-1,+1,+1,-1];etaJ=[-1,-1,+1,+1];% compute element stiffnessfor j=1:4   je=node(j,e);   xe(j)=x(je);   ye(j)=y(je);end% summation for Gauss integrationfor i=1:2     for j=1:2           ksi=gauss(i);          eta=gauss(j);            NJksi=.25*ksiJ.*(one+eta*etaJ);          NJeta=.25*etaJ.*(one+ksi*ksiJ);          xksi=NJksi*xe'; yksi=NJksi*ye';           xeta=NJeta*xe'; yeta=NJeta*ye';          Jinv=[yeta,-yksi;-xeta,xksi];          jcob=xksi*yeta-xeta*yksi;          NJdksieta=[NJksi;NJeta];          NJdxy=Jinv*NJdksieta;          BJ=zeros(3,8);          BJ(1,1:2:7)=NJdxy(1,1:4);          BJ(2,2:2:8)=NJdxy(2,1:4);          BJ(3,1:2:7)=NJdxy(2,1:4);          BJ(3,2:2:8)=NJdxy(1,1:4);				% plane stress          fac=young(e)/(1.-pr(e)^2);            D=fac*[1.,      pr(e),   0;                 pr(e),   1.,      0;                 0,       0,       (1.-pr(e))/2];        								          ke=ke+BJ'*D*BJ/jcob;      end   % end jend  % end i